(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[217],{3951:(e,i,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/shopproduct",function(){return t(2266)}])},2266:(e,i,t)=>{"use strict";t.r(i),t.d(i,{default:()=>a});var o=t(4848),d=t(1405),l=t.n(d),s=t(6540),r=t(7037),n=t(6424);function a(){let[e,i]=(0,s.useState)([]),[t,d]=(0,s.useState)([]),[a,c]=(0,s.useState)([]),p=(0,n.useRouter)(),[h,u]=(0,s.useState)({shop_id:0,product_id:0,price:0,note:"",description:"",position:0,availability:[]}),[m,_]=(0,s.useState)(""),[j,x]=(0,s.useState)(null);async function v(){let e=await fetch("/api/shop"),t=await e.json();t&&t.length>0&&i(t)}async function b(){let e=await fetch("/api/ic_product"),i=await e.json();i&&i.length>0&&c(i)}async function g(){let e=await fetch("/api/shop_products"),i=await e.json();i&&i.length>0&&d(i)}(0,s.useEffect)(()=>{localStorage.getItem("admin_code")?(v(),b(),g()):p.push("/admin")},[]),(0,s.useEffect)(()=>{u(e=>({...e,position:(null==t?void 0:t.length)||0}))},[t]);let f=e=>{let i="number"===e.target.type?Number(e.target.value):e.target.value;u({...h,[e.target.name]:i})},y=async e=>{e.preventDefault();let i=j?"PUT":"POST",t=j?{...h,id:j}:h;t.product_id=Number(t.product_id),t.price=Number(t.price),t.shop_id=Number(t.shop_id),t.position=Number(t.position);let o=await fetch("/api/shop_products",{method:i,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});o.ok?(g(),u({shop_id:0,product_id:0,price:"",note:"",description:"",position:0,availability:[]}),x(null)):400===o.status&&_("Product already exists")},N=e=>{u(e),x(e.id)},k=async e=>{(await fetch("/api/shop_products",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok&&g()};return(0,o.jsxs)("div",{className:l().container,children:[(0,o.jsx)("h1",{className:l().title,children:"Manage Shop Products"}),(0,o.jsx)("p",{className:l().error,children:m}),(0,o.jsxs)("form",{onSubmit:y,className:l().form,children:[(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"shop_id",children:"Shop"}),(0,o.jsxs)("select",{id:"shop_id",name:"shop_id",value:h.shop_id,onChange:f,children:[(0,o.jsx)("option",{value:0,children:"Select Shop"}),e.map(e=>(0,o.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"product_id",children:"Product"}),(0,o.jsxs)("select",{id:"product_id",name:"product_id",value:h.product_id,onChange:f,children:[(0,o.jsx)("option",{value:0,children:"Select Product"}),a.map(e=>(0,o.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,o.jsxs)("div",{className:l().formGroup,children:["pe",(0,o.jsx)("label",{htmlFor:"type",children:"Type"}),(0,o.jsxs)("select",{id:"type",name:"type",value:h.type,onChange:f,children:[(0,o.jsx)("option",{value:0,children:"Select Type"}),(0,o.jsx)("option",{value:"kg",children:"KG"}),(0,o.jsx)("option",{value:"litter",children:"Litter"})]})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"price",children:"Price"}),(0,o.jsx)("input",{type:"text",id:"price",name:"price",placeholder:"Price",value:h.price,onChange:f})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"note",children:"Note"}),(0,o.jsx)("input",{id:"note",name:"note",placeholder:"Note",value:h.note,onChange:f})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"description",children:"Description"}),(0,o.jsx)("input",{id:"description",name:"description",placeholder:"Description",value:h.description,onChange:f})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"availability",children:"Available In"}),(0,o.jsx)("select",{id:"availability",name:"availability",multiple:!0,value:h.availability,onChange:e=>{let i=Array.from(e.target.selectedOptions,e=>e.value);u({...h,availability:i})},children:["100gm","200gm","500gm","1kg","2kg","5kg","10kg","15kg","20kg","30kg","40kg","50kg"].map((e,i)=>(0,o.jsx)("option",{value:e,children:e},i))})]}),(0,o.jsxs)("div",{className:l().formGroup,children:[(0,o.jsx)("label",{htmlFor:"position",children:"Position"}),(0,o.jsx)("input",{type:"text",id:"position",name:"position",placeholder:"Position",value:h.position,onChange:f})]}),(0,o.jsx)("div",{className:l().formGroup,children:(0,o.jsx)("button",{type:"submit",className:l().addproduct,children:j?"Update":"Add"})})]}),(0,o.jsxs)("table",{className:l().table,children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"ID"}),(0,o.jsx)("th",{children:"Shop"}),(0,o.jsx)("th",{children:"Image"}),(0,o.jsx)("th",{children:"Product"}),(0,o.jsx)("th",{children:"Price"}),(0,o.jsx)("th",{children:"Note"}),(0,o.jsx)("th",{children:"Description"}),(0,o.jsx)("th",{children:"Availability"}),(0,o.jsx)("th",{children:"Position"}),(0,o.jsx)("th",{children:"Actions"})]})}),(0,o.jsx)("tbody",{children:t.length>0&&t.map(i=>{var t,d,s,n,c;return(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:i.id}),(0,o.jsx)("td",{children:(null===(t=e.find(e=>e.id===i.shop_id))||void 0===t?void 0:t.name)||"N/A"}),(0,o.jsx)("td",{children:(null===(d=a.find(e=>e.id===i.product_id))||void 0===d?void 0:d.image_url)&&(0,o.jsx)("img",{src:null===(s=a.find(e=>e.id===i.product_id))||void 0===s?void 0:s.image_url,alt:null===(n=a.find(e=>e.id===i.product_id))||void 0===n?void 0:n.title,className:l().previewImage})}),(0,o.jsx)("td",{children:(null===(c=a.find(e=>e.id===i.product_id))||void 0===c?void 0:c.title)||"N/A"}),(0,o.jsxs)("td",{children:[i.price," ",i.type]}),(0,o.jsx)("td",{children:i.note}),(0,o.jsx)("td",{children:i.description}),(0,o.jsx)("td",{children:i.availability?i.availability.join(", "):""}),(0,o.jsx)("td",{children:i.position}),(0,o.jsxs)("td",{children:[(0,o.jsx)("button",{onClick:()=>N(i),className:l().editbtn,children:(0,o.jsx)(r.uO9,{})}),(0,o.jsx)("button",{onClick:()=>k(i.id),className:l().deletebtn,children:(0,o.jsx)(r.qbC,{})})]})]},i.id)})})]})]})}},1405:e=>{e.exports={container:"shopproduct_container__cXlz8",title:"shopproduct_title__oIbyN",error:"shopproduct_error__FmhkK",previewImage:"shopproduct_previewImage__Uiw_C",form:"shopproduct_form__QAvRw","form-group":"shopproduct_form-group__2ftt8",addproduct:"shopproduct_addproduct__eEJeA",table:"shopproduct_table__6eu7_",productImage:"shopproduct_productImage__Ru4SB",editbtn:"shopproduct_editbtn__F8_AQ",deletebtn:"shopproduct_deletebtn__JVRBF"}}},e=>{var i=i=>e(e.s=i);e.O(0,[563,542,636,593,792],()=>i(3951)),_N_E=e.O()}]);