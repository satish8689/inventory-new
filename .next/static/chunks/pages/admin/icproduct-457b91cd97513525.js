(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[13],{1507:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/icproduct",function(){return a(266)}])},266:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var i=a(4848),r=a(6373),n=a.n(r),o=a(6540),l=a(7037),c=a(1301),d=a.n(c),s=a(6424);function u(){let[e,t]=(0,o.useState)([]),[a,r]=(0,o.useState)({title:"",image_url:""}),[c,u]=(0,o.useState)(""),[h,g]=(0,o.useState)(null),p=(0,s.useRouter)();async function m(){let e=await fetch("/api/ic_product"),a=await e.json();a&&a.length>0&&t(a)}(0,o.useEffect)(()=>{localStorage.getItem("admin_code")?m():p.push("/admin")},[]);let f=async e=>{e.preventDefault(),console.log("form",a,h);let t=h?{...a,id:h}:a,i=await fetch("/api/ic_product",{method:h?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});i.ok?(m(),r({title:"",image_url:""}),g(null)):400==i.status&&u("Product already exists")},b=e=>{r(e),g(e.id)},_=async a=>{(await fetch("/api/ic_product",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})})).ok&&t(e.filter(e=>e.id!==a))};return(0,i.jsxs)("div",{className:n().container,children:[(0,i.jsx)("h1",{className:n().title,children:"Manage Shop Products"}),(0,i.jsxs)("p",{className:n().error,children:[" ",c," "]}),(0,i.jsxs)("form",{onSubmit:f,className:n().form,children:[a.image_url&&(0,i.jsx)("img",{src:a.image_url,alt:"Preview",className:n().previewImage}),(0,i.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{let t=e.target.files[0];t&&d().imageFileResizer(t,100,100,"JPEG",100,0,e=>{r({...a,image_url:e})},"base64")}}),(0,i.jsx)("input",{name:"title",placeholder:"Title",value:a.title,onChange:e=>{r({...a,[e.target.name]:e.target.value})}}),(0,i.jsx)("button",{type:"submit",className:n().addproduct,children:h?"Update":"Add"})]}),(0,i.jsxs)("table",{className:n().table,children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{children:"ID"}),(0,i.jsx)("th",{children:"Image"}),(0,i.jsx)("th",{children:"Title"}),(0,i.jsx)("th",{children:"Actions"})]})}),(0,i.jsx)("tbody",{children:e.length>0&&e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{children:e.id}),(0,i.jsx)("td",{children:(0,i.jsx)("img",{src:e.image_url,alt:e.title,className:n().productImage})}),(0,i.jsx)("td",{children:e.title}),(0,i.jsxs)("td",{children:[(0,i.jsxs)("button",{onClick:()=>b(e),className:n().editbtn,children:[" ",(0,i.jsx)(l.uO9,{})]}),(0,i.jsxs)("button",{onClick:()=>_(e.id),className:n().deletebtn,children:[" ",(0,i.jsx)(l.qbC,{})]})]})]},e.id))})]})]})}},6373:e=>{e.exports={container:"icproduct_container__Xv4Hu",title:"icproduct_title__MjZkT",error:"icproduct_error___jRIi",form:"icproduct_form__nSVRL",previewImage:"icproduct_previewImage__0HFmB",addproduct:"icproduct_addproduct__L3aXh",table:"icproduct_table__jd6in",productImage:"icproduct_productImage__YLku4",editbtn:"icproduct_editbtn__thPyR",deletebtn:"icproduct_deletebtn__spUjl"}},1301:e=>{(()=>{"use strict";var t={d:(e,a)=>{for(var i in a)t.o(a,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:a[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},a={};t.r(a),t.d(a,{default:()=>r});var i=function(){var e;function t(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t)}return e=[{key:"changeHeightWidth",value:function(e,t,a,i,r,n){return a>i&&(e=Math.round(e*i/a),a=i),e>t&&(a=Math.round(a*t/e),e=t),r&&a<r&&(e=Math.round(e*r/a),a=r),n&&e<n&&(a=Math.round(a*n/e),e=n),{height:e,width:a}}},{key:"resizeAndRotateImage",value:function(e,t,a,i,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=document.createElement("canvas"),d=e.width,s=e.height,u=this.changeHeightWidth(s,a,d,t,i,r);l&&(90===l||270===l)?(c.width=u.height,c.height=u.width):(c.width=u.width,c.height=u.height),d=u.width,s=u.height;var h=c.getContext("2d");return h.fillStyle="rgba(0, 0, 0, 0)",h.fillRect(0,0,d,s),h.imageSmoothingEnabled&&h.imageSmoothingQuality&&(h.imageSmoothingQuality="high"),l&&(h.rotate(l*Math.PI/180),90===l?h.translate(0,-c.width):180===l?h.translate(-c.width,-c.height):270===l?h.translate(-c.height,0):0!==l&&360!==l||h.translate(0,0)),h.drawImage(e,0,0,d,s),c.toDataURL("image/".concat(n),o/100)}},{key:"b64toByteArrays",value:function(e,t){t=t||"image/jpeg";for(var a=atob(e.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),i=[],r=0;r<a.length;r+=512){for(var n=a.slice(r,r+512),o=Array(n.length),l=0;l<n.length;l++)o[l]=n.charCodeAt(l);var c=new Uint8Array(o);i.push(c)}return i}},{key:"b64toBlob",value:function(e,t){return new Blob(this.b64toByteArrays(e,t),{type:t,lastModified:new Date})}},{key:"b64toFile",value:function(e,t,a){return new File(this.b64toByteArrays(e,a),t,{type:a,lastModified:new Date})}},{key:"createResizedImage",value:function(e,a,i,r,n,o,l){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,s=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,u=new FileReader;if(!e)throw Error("File Not Found!");if(e.type&&!e.type.includes("image"))throw Error("File Is NOT Image!");u.readAsDataURL(e),u.onload=function(){var h=new Image;h.src=u.result,h.onload=function(){var u=t.resizeAndRotateImage(h,a,i,d,s,r,n,o),g="image/".concat(r);switch(c){case"blob":l(t.b64toBlob(u,g));break;case"base64":default:l(u);break;case"file":var p=e.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(r.toString());l(t.b64toFile(u,p,g))}}},u.onerror=function(e){throw Error(e)}}}],function(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}(t,e),t}();let r={imageFileResizer:function(e,t,a,r,n,o,l,c,d,s){return i.createResizedImage(e,t,a,r,n,o,l,c,d,s)}};e.exports=a})()}},e=>{var t=t=>e(e.s=t);e.O(0,[563,542,636,593,792],()=>t(1507)),_N_E=e.O()}]);