(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[268],{939:(t,e,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/products",function(){return r(19)}])},200:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var a=r(4848),o=r(6540),c=r(7037),s=r(3596);r(3246);var n=r(9850),i=r.n(n);function l(t){let{selectedProducts:e=[],setSelectedProducts:r,goBack:n}=t,[l,d]=(0,o.useState)(0);(0,o.useEffect)(()=>{if(!Array.isArray(e)||0===e.length){d(0);return}d(e.reduce((t,e)=>t+(e.proTotalPrice||0),0))},[e]);let u=t=>{Array.isArray(e)&&r(e.filter(e=>e.id!==t))},p=async()=>{let t=new s.default,r=JSON.parse(localStorage.getItem("userInfo")||"{}"),a=r.name||"Unknown",o=r.mobile||"N/A",c="Test Shop",n="+91 1234567890";t.setFontSize(16),t.text("Order Summary",80,10),t.setFontSize(12),t.text("Customer: ".concat(a),14,20),t.text("Contact: ".concat(o),14,30),t.text("Shop: ".concat(c),120,20),t.text("Shop Contact: ".concat(n),120,30);let i=0,l=0,d=e.length,u=e.map((t,e)=>{var r;let a=parseFloat(t.quantity)||0;(null===(r=t.quantity)||void 0===r?void 0:r.includes("g"))&&(a/=1e3);let o=a*(t.price||0);return i+=o,l+=a,[e+1,t.title||"N/A",t.quantity||"N/A","Rs ".concat(t.price||0),"Rs ".concat(o.toFixed(2))]});t.autoTable({head:[["#","Product","Quantity","Unit Price","Total Price"]],body:u,startY:40});let p=t.output("blob"),m=new FormData;m.append("file",p,"Order_Summary.pdf");let _=await fetch("/api/orders",{method:"POST",body:m});if(_.ok){let t=await _.json(),e="".concat(window.location.origin).concat(t.fileUrl),r=encodeURIComponent("\uD83D\uDED2 *Order Summary*\n\uD83D\uDC64 Name: ".concat(a,"\n\uD83D\uDCDE Contact: ").concat(o,"\n\uD83D\uDECD️ Shop: ").concat(c,"\n\uD83D\uDCF2 Shop Contact: ").concat(n,"\n\n\uD83D\uDCE6 *Total Products:* ").concat(d,"\n\uD83D\uDD22 *Total Quantity:* ").concat(l.toFixed(2)," kg\n\uD83D\uDCB0 *Total Amount:* Rs ").concat(i.toFixed(2),"\n\uD83D\uDCCE Download Invoice: ").concat(e));window.open("https://wa.me/+918602148689?text=".concat(r),"_blank")}else alert("Failed to store the PDF.")};return(0,a.jsxs)("div",{className:i().container,children:[(0,a.jsxs)("header",{className:i().header,children:[(0,a.jsx)("button",{onClick:n,className:i().backButton,children:"← Back"}),(0,a.jsx)("h1",{children:"Order Summary"})]}),(0,a.jsx)("div",{className:i().orderList,children:e.length>0?e.map(t=>(0,a.jsxs)("div",{className:i().orderItem,children:[(0,a.jsx)("img",{src:t.productImage,alt:t.title||"Product",className:i().productImage}),(0,a.jsx)("p",{className:i().productTitle,children:t.title||"N/A"}),(0,a.jsxs)("p",{className:i().quantity,children:["Qty: ",t.quantity||"N/A"]}),(0,a.jsxs)("p",{className:i().price,children:["Rs ",t.price||0]}),(0,a.jsxs)("p",{className:i().totalPrice,children:["Rs ",(t.proTotalPrice||0).toFixed(2)]}),(0,a.jsx)("button",{onClick:()=>u(t.id),className:i().removeButton,children:(0,a.jsx)(c.qbC,{})})]},t.id)):(0,a.jsx)("p",{children:"No products selected."})}),(0,a.jsxs)("footer",{className:i().footer,children:[(0,a.jsxs)("div",{className:i().summary,children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Products:"})," ",e.length]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total Amount:"})," Rs ",l.toFixed(2)]})]}),(0,a.jsxs)("button",{onClick:p,className:i().whatsappButton,children:[(0,a.jsx)(c.EcP,{})," Place Order"]})]})]})}},19:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>i});var a=r(4848),o=r(6540),c=r(4863),s=r.n(c),n=r(200);function i(){let[t,e]=(0,o.useState)([]),[r,c]=(0,o.useState)([]),[i,l]=(0,o.useState)(""),[d,u]=(0,o.useState)([]),[p,m]=(0,o.useState)(!1),[_,h]=(0,o.useState)(!0),[x,N]=(0,o.useState)(!1),[y,j]=(0,o.useState)(""),[S,v]=(0,o.useState)("");async function f(){let t=await fetch("/api/ic_product"),e=await t.json();if(e&&e.length>0)return u(e),e}async function g(){let t=await f(),r=await fetch("/api/products"),a=await r.json();a&&a.length>0&&e(a.map(e=>{let r=t.find(t=>t.id===e.product_id),a=null==r?void 0:r.title.split("||");return console.log("productTitleDesplay",a[0]),{productTitle:a[0]?a[0]:"",productImage:(null==r?void 0:r.image_url)||"",...e}})),h(!1)}(0,o.useEffect)(()=>{let t=localStorage.getItem("userInfo");if(t){let e=JSON.parse(t);j(e.name),v(e.mobile)}else N(!0);g()},[]);let C=(e,r)=>{let a=t.find(t=>t.id===e);if(!a)return;let o=parseFloat(r),s=(r.includes("kg")?o:o/1e3)*a.price;c(t=>{let e=t.map(t=>t.title===a.productTitle?{...t,quantity:r,proTotalPrice:s}:t);return r?t.some(t=>t.title===a.productTitle)||e.push({id:a.id,title:a.productTitle,productImage:a.productImage,price:a.price,type:a.type,quantity:r,proTotalPrice:s}):e=e.filter(t=>t.title!==a.productTitle),e})};if(p)return(0,a.jsx)(n.default,{selectedProducts:r,setSelectedProducts:c,goBack:()=>{m(!1)}});let D=t.filter(t=>!i||t.productTitle&&t.productTitle.toLowerCase().includes(i.toLowerCase()));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:s().header,children:[(0,a.jsx)("div",{className:s().shopName,children:"My Shop"}),(0,a.jsx)("br",{}),(0,a.jsx)("div",{className:s().searchBoxCont,children:(0,a.jsx)("input",{type:"text",placeholder:"Search products...",value:i,onChange:t=>l(t.target.value),className:s().searchBox})})]}),(0,a.jsxs)("div",{className:s().container,children:[x&&(0,a.jsx)("div",{className:s().popup,children:(0,a.jsxs)("div",{className:s().popupContent,children:[(0,a.jsx)("h2",{children:"Enter Your Details"}),(0,a.jsx)("input",{type:"text",placeholder:"Enter Name",value:y,onChange:t=>j(t.target.value),className:s().input}),(0,a.jsx)("input",{type:"tel",placeholder:"Enter Mobile Number",value:S,onChange:t=>v(t.target.value),className:s().input}),(0,a.jsx)("button",{onClick:()=>{if(!y.trim()||!S.trim()){alert("Please enter valid Name and Mobile Number");return}if(!/^\d{10}$/.test(S)){alert("Please enter a valid 10-digit mobile number.");return}localStorage.setItem("userInfo",JSON.stringify({name:y,mobile:S})),N(!1)},className:s().submitButton,children:"Submit"})]})}),_?(0,a.jsx)("div",{className:s().loadercontainer,children:(0,a.jsx)("div",{className:s().loader})}):(0,a.jsx)("div",{className:s().productList,children:D.length>0?D.map(t=>{var e;let o=r.find(e=>e.title===t.productTitle);return(0,a.jsxs)("div",{className:s().productCard,children:[(0,a.jsx)("img",{src:t.productImage,alt:t.productTitle,className:s().productImage}),(0,a.jsxs)("div",{className:s().productDetails,children:[(0,a.jsxs)("div",{className:s().actions,children:[(0,a.jsx)("span",{className:s().productTitle,children:t.productTitle}),(0,a.jsxs)("select",{value:(null==o?void 0:o.quantity)||"",onChange:e=>C(t.id,e.target.value),className:s().quantitySelect,children:[(0,a.jsx)("option",{value:"",children:"Select Quantity"}),null===(e=t.availability)||void 0===e?void 0:e.map((t,e)=>(0,a.jsx)("option",{value:t,children:t},e))]})]}),(0,a.jsxs)("span",{className:s().productPrice,children:["Rs ",t.price," / 1",t.type]}),(0,a.jsx)("span",{className:s().productNote,children:t.note}),(0,a.jsx)("span",{className:s().productNote,children:t.description})]})]},t.id)}):(0,a.jsx)("p",{children:"No products available"})}),(0,a.jsx)("button",{onClick:()=>{m(!0)},className:s().orderButton,children:"Order Summary"})]})]})}},9850:t=>{t.exports={container:"orderSummary_container__2Adoy",header:"orderSummary_header__uG_o4",backButton:"orderSummary_backButton__qQhvC",orderList:"orderSummary_orderList__JWa4d",orderItem:"orderSummary_orderItem__4g7Eh",productImage:"orderSummary_productImage__lejcR",productTitle:"orderSummary_productTitle__ojjBp",quantity:"orderSummary_quantity__i10QI",price:"orderSummary_price__FbZds",totalPrice:"orderSummary_totalPrice__PidqZ",removeButton:"orderSummary_removeButton__OQO_r",footer:"orderSummary_footer__myQJN",summary:"orderSummary_summary__DXPEU",whatsappButton:"orderSummary_whatsappButton___zsra"}},4863:t=>{t.exports={container:"products_container__Nk86u",__next:"products___next__OazHf",header:"products_header__ywfTt",shopName:"products_shopName__8ya2T",searchBoxCont:"products_searchBoxCont__bvNKv",searchBox:"products_searchBox__HSflH",productList:"products_productList__CGdhV",productCard:"products_productCard__p5i2p",productImage:"products_productImage___BNjx",productDetails:"products_productDetails__J84Mt",productTitle:"products_productTitle__YXzfX",productPrice:"products_productPrice__gN0WR",productNote:"products_productNote__Q4NgS",quantitySelect:"products_quantitySelect__jnRM_",actionIcons:"products_actionIcons__lGBCz",iconButton:"products_iconButton__63y67",orderButton:"products_orderButton__COebp",popup:"products_popup__5Qzh4",popupContent:"products_popupContent__dApcB",input:"products_input__LsfwR",submitButton:"products_submitButton__nziv_",loadercontainer:"products_loadercontainer__Lfa4c",loader:"products_loader__VkSx4",spin:"products_spin__y576n"}}},t=>{var e=e=>t(t.s=e);t.O(0,[563,673,831,636,593,792],()=>e(939)),_N_E=t.O()}]);